(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{"0Yji":function(e,t,s){},"2nmD":function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"es":{"reset_password":"Restablecer Contrase√±a","modal":{"title":"Usuario","subtitle":" "},"item":{"username":{"label":"Nombre","placeholder":"Nombre de usuario","helper":"Nombre que usara este usuario para login. Debe ser unico"},"displayname":{"label":"Nombre","placeholder":"Nombre Completo","helper":"Nombre propio del usuario"},"description":{"label":"Descripcion","placeholder":"...","helper":"Descripcion del usuario"},"role":{"label":"Rol","placeholder":"Seleccione...","helper":"Roles para este usuario"}}}}'),delete e.options._Ctor}},CBi8:function(e,t,s){"use strict";var i=s("Mnv2"),r=s.n(i);r.a},KM7y:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"group"},[s("q-field",{attrs:{label:e.$t("password"),error:e.$v.password1.$error,"error-label":"",helper:e.$t("password_new")}},[s("q-input",{attrs:{type:"password"},on:{input:function(t){e.$v.password1.$touch()}},model:{value:e.password1,callback:function(t){e.password1=t},expression:"password1"}})],1),s("q-field",{attrs:{label:e.$t("password"),error:e.$v.password2.$error,"error-label":e.$t("password_missmatch"),helper:e.$t("password_repeat")}},[s("q-input",{attrs:{type:"password"},on:{blur:function(t){e.$v.password2.$touch()}},model:{value:e.password2,callback:function(t){e.password2=t},expression:"password2"}})],1),s("q-field",{attrs:{label:e.$t("password_strength")}},[s("q-progress",{staticClass:"q-my-md",attrs:{percentage:20*e.passwordStrength,color:e.passwordStrengthColor,height:"6px"}})],1),s("div",{staticClass:"text-center q-py-sm"},[s("q-btn",{attrs:{disable:e.$v.$invalid,size:"lg",color:"negative",outline:"",label:e.$t("password_reset")},on:{click:function(t){e.confirm()}}})],1)],1)},r=[];i._withStripped=!0;var o=s("MVZn"),a=s.n(o),n=s("WA7+"),l=s.n(n),d=s("2LSj"),c=s("L2JU"),u=s("ta7f"),p={name:"ResetPassword",props:{userId:String,username:String,own:Boolean},data:function(){return{password1:"",password2:""}},validations:{password1:{},password2:{sameAs:Object(u["sameAs"])("password1")}},computed:a()({passwordStrength:function(){return""===this.password1?0:l()(this.password1,["guembe"]).score+1},passwordStrengthColor:function(){switch(this.passwordStrength){case 0:return"negative";case 1:return"negative";case 2:return"warning";case 3:return"info";case 4:return"positive";case 5:return"positive"}}},Object(c["e"])("core",{session:"session"})),methods:{reset:function(){this.$v.$reset(),this.password1="",this.password2=""},confirm:function(){var e=this;this.$q.dialog({title:this.$t("reset_title"),message:"".concat(this.$t("reset_message")," ").concat(this.username?this.username:this.session?this.session.user.username:""),ok:!0,cancel:!0}).then(function(){e.update()}).catch(function(){})},update:function(){var e=this,t={};this.own?t.own=!0:t.user_id=this.userId,this.$axios.put(d["c"],{password:this.password1},{params:t}).then(function(){e.$q.notify({message:e.$t("password_reset_success"),type:"positive"})}).catch(function(){e.reset(),e.$q.notify({message:e.$t("password_reset_error"),type:"negative"})})}}},m=p,h=(s("CBi8"),s("KHd+")),f=s("uoC4"),$=Object(h["a"])(m,i,r,!1,null,null,null);"function"===typeof f["default"]&&Object(f["default"])($);t["a"]=$.exports},Mnv2:function(e,t,s){},NNmX:function(e,t,s){"use strict";t["a"]={methods:{validationError:function(e){for(var t in e.$params)if(e.hasOwnProperty(t)&&!1===e[t])return this.$t("validation.".concat(t));return this.$t("validation.error")}}}},RwI2:function(e,t,s){"use strict";s("yt8O"),s("RW0V"),s("rGqo");var i=s("MVZn"),r=s.n(i),o=s("L2JU");t["a"]={computed:r()({},Object(o["c"])("core",{isAuthorized:"isAuthorized"})),methods:{createItem:function(e){var t=this;this.$q.dialog({title:this.$t("confirm.createItem.title"),message:this.$t("confirm.createItem.message"),ok:!0,cancel:!0}).then(function(){t.$q.loading.show(),t.$axios.post(t.apiRoute,e).then(function(){t.$q.loading.hide(),t.$q.notify({message:t.$t("operation.create.success"),type:"positive"}),t.reset(),t.fetchItems()}).catch(function(){t.$q.loading.hide(),t.$q.notify({message:t.$t("operation.create.failure"),type:"warning"})})})},updateItem:function(e){var t=this;this.$q.dialog({title:this.$t("confirm.updateItem.title"),message:this.$t("confirm.updateItem.message"),ok:!0,cancel:!0}).then(function(){t.$q.loading.show(),t.$axios.put(t.apiRoute,e).then(function(){t.$q.loading.hide(),t.$q.notify({message:t.$t("operation.update.success"),type:"positive"}),t.reset(),t.fetchItems()}).catch(function(){t.$q.loading.hide(),t.$q.notify({message:t.$t("operation.update.failure"),type:"warning"})})})},deleteItem:function(e){var t=this;this.$q.dialog({title:this.$t("confirm.deleteItem.title"),message:this.$t("confirm.deleteItem.message"),ok:!0,cancel:!0}).then(function(){t.$q.loading.show(),t.$axios.delete(t.apiRoute,{params:t.deleteParams(e)}).then(function(){t.$q.loading.hide(),t.$q.notify({message:t.$t("operation.delete.success"),type:"positive"}),t.reset(),t.fetchItems()}).catch(function(){t.$q.loading.hide(),t.$q.notify({message:t.$t("operation.delete.failure"),type:"positive"})})})},edit:function(e){var t=this;e?(this.editMode=!0,this.item=JSON.parse(JSON.stringify(e)),this.mapItemOptions&&Object.keys(this.mapItemOptions).forEach(function(e){Array.isArray(t.item[e])?t.item[e]=t.item[e].map(t.mapItemOptions[e]):t.item[e]&&(t.item[e]=t.mapItemOptions[e](t.item[e]))}),delete this.item.__index):this.editMode=!1,this.$refs.modal.show()},reset:function(){this.$refs.modal.hide(),this.$v.$reset(),this.item=this.newItem()},cancel:function(){var e=this;this.$v.$anyDirty?this.$q.dialog({title:this.$t("confirm.cancelEdit.title"),message:this.$t("confirm.cancelEdit.message"),ok:!0,cancel:!0}).then(function(){e.reset()}):this.reset()}}}},Xpni:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-page",[s("q-table",{staticClass:"no-shadow",attrs:{title:e.table.title,"row-key":e.table.rowKey,loading:e.table.loading,data:e.table.data,columns:e.table.columns,filter:e.table.filter,pagination:e.table.pagination},on:{"update:pagination":function(t){e.$set(e.table,"pagination",t)}},scopedSlots:e._u([{key:"top-left",fn:function(t){return[s("q-btn",{staticClass:"q-mr-sm",attrs:{round:"",flat:"",color:"primary",icon:"refresh",size:"md"},on:{click:function(t){e.fetchItems()}}}),s("q-search",{staticClass:"col-6",attrs:{"hide-underline":"",color:"secondary"},model:{value:e.table.filter,callback:function(t){e.$set(e.table,"filter",t)},expression:"table.filter"}})]}},{key:"top-right",fn:function(t){return[e.isAuthorized(e.resource,"create","any")?s("q-btn",{attrs:{round:"",color:"positive",icon:"add",size:"md"},on:{click:function(t){e.edit()}}}):e._e()]}},{key:"body-cell-password-reset",fn:function(t){return s("q-td",{attrs:{props:t,"auto-width":""}},[e.isAuthorized("CorePassword",["update"],"any")?s("q-btn",{attrs:{size:"md",round:"",dense:"",flat:"",icon:"lock_open",color:"negative"},on:{click:function(s){e.resetPassword(t.row)}}}):e._e()],1)}},{key:"body-cell-edit",fn:function(t){return s("q-td",{attrs:{props:t,"auto-width":""}},[e.isAuthorized(e.resource,["update","delete"],"any")?s("q-btn",{attrs:{size:"md",round:"",dense:"",flat:"",icon:"edit",color:"dark"},on:{click:function(s){e.edit(t.row)}}}):e._e()],1)}}])}),s("q-modal",{ref:"passwordResetModal",attrs:{"content-css":"width: 80vw; height: 80vh;"},on:{hide:function(t){e.$refs.passwordreset.reset()}}},[s("q-modal-layout",[s("q-toolbar",{staticClass:"q-py-none q-pr-none",attrs:{slot:"header"},slot:"header"},[s("q-toolbar-title",[e._v("\n          "+e._s(e.$t("reset_password"))+"\n        ")]),s("q-btn",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],staticClass:"no-shadow",staticStyle:{"border-radius":"0"},attrs:{icon:"close",color:"negative",size:"lg"}})],1),s("q-toolbar",{staticClass:"justify-around q-py-sm",attrs:{slot:"footer",align:"around"},slot:"footer"}),s("div",{staticClass:"layout-padding"},[s("reset-password",{ref:"passwordreset",attrs:{"user-id":e.passwordResetUserId}})],1)],1)],1),s("q-modal",{ref:"modal",attrs:{"no-esc-dismiss":"","no-backdrop-dismiss":"","content-css":"width: 80vw; height: 80vh;"}},[s("q-modal-layout",[s("q-toolbar",{staticClass:"q-py-none q-pr-none",attrs:{slot:"header"},slot:"header"},[s("q-toolbar-title",[e._v("\n          "+e._s(e.editMode?e.$t("edit"):e.$t("create"))+" "+e._s(e.$t("modal.title"))+"\n          "),s("span",{attrs:{slot:"subtitle"},slot:"subtitle"},[e._v(e._s(e.$t("modal.subtitle")))])]),s("q-btn",{staticClass:"no-shadow",staticStyle:{"border-radius":"0"},attrs:{icon:"close",color:"negative",size:"lg"},on:{click:function(t){e.cancel()}}})],1),s("q-toolbar",{staticClass:"justify-around q-py-sm",attrs:{slot:"footer",align:"around"},slot:"footer"},[e.editMode?[e.isAuthorized(e.resource,"delete","any")?s("q-btn",{attrs:{size:"lg",rounded:"",color:"negative",icon:"delete"},on:{click:function(t){e.deleteItem(e.item)}}},[e._v(e._s(e.$t("buttons.deleteItem")))]):e._e(),e.isAuthorized(e.resource,"update","any")?s("q-btn",{attrs:{size:"lg",rounded:"",color:"positive",icon:"save",disable:e.$v.item.$invalid},on:{click:function(t){e.updateItem(e.item)}}},[e._v(e._s(e.$t("buttons.updateItem")))]):e._e()]:[e.isAuthorized(e.resource,"create","any")?s("q-btn",{attrs:{size:"lg",rounded:"",color:"positive",icon:"create",disable:e.$v.item.$invalid},on:{click:function(t){e.createItem(e.item)}}},[e._v(e._s(e.$t("buttons.createItem")))]):e._e()]],2),s("div",{staticClass:"layout-padding group"},[s("q-field",{attrs:{label:e.$t("item.username.label"),helper:e.$t("item.username.helper"),error:e.$v.item.username.$error,"error-label":e.validationError(e.$v.item.username)}},[s("q-input",{attrs:{placeholder:e.$t("item.username.placeholder")},on:{blur:function(t){e.$v.item.username.$touch()}},model:{value:e.item.username,callback:function(t){e.$set(e.item,"username",t)},expression:"item.username"}})],1),s("q-field",{attrs:{label:e.$t("item.displayname.label"),helper:e.$t("item.displayname.helper"),error:e.$v.item.displayname.$error,"error-label":e.validationError(e.$v.item.displayname)}},[s("q-input",{attrs:{placeholder:e.$t("item.displayname.placeholder")},on:{blur:function(t){e.$v.item.displayname.$touch()}},model:{value:e.item.displayname,callback:function(t){e.$set(e.item,"displayname",t)},expression:"item.displayname"}})],1),s("q-field",{attrs:{label:e.$t("item.description.label"),helper:e.$t("item.description.helper"),error:e.$v.item.description.$error,"error-label":e.validationError(e.$v.item.description)}},[s("q-input",{attrs:{placeholder:e.$t("item.description.placeholder")},on:{blur:function(t){e.$v.item.description.$touch()}},model:{value:e.item.description,callback:function(t){e.$set(e.item,"description",t)},expression:"item.description"}})],1),s("q-field",{attrs:{label:e.$t("item.role.label"),helper:e.$t("item.role.helper"),error:e.$v.item.role.$error,"error-label":e.validationError(e.$v.item.role)}},[s("q-select",{attrs:{multiple:"",options:e.options.roles,placeholder:e.$t("item.role.placeholder")},on:{blur:function(t){e.$v.item.role.$touch()}},model:{value:e.item.role,callback:function(t){e.$set(e.item,"role",t)},expression:"item.role"}})],1)],1)],1)],1)],1)},r=[];i._withStripped=!0;s("VRzm"),s("rGqo"),s("yt8O"),s("dRSK");var o=s("2LSj"),a=s("RwI2"),n=s("NNmX"),l=s("KM7y"),d=s("ta7f");function c(){return{username:"",displayname:"",description:"",role:[]}}var u={name:"ConfigurePrivileges",mixins:[a["a"],n["a"]],components:{ResetPassword:l["a"]},data:function(){var e=this;return{passwordResetUserId:null,resource:"CorePrivilege",apiRoute:o["h"],editMode:!1,item:c(),mapItemOptions:{role:function(t){return e.options.roles.find(function(e){return e.value.role_id===t.role_id}).value}},options:{roles:[]},table:{loading:!1,rowKey:"user_id",title:"",filter:"",data:[],pagination:{sortBy:null,descending:!1,page:1,rowsPerPage:10},columns:[{name:"username",required:!0,label:this.$t("item.username.label"),align:"left",field:"username",sortable:!0},{name:"displayname",required:!0,label:this.$t("item.displayname.label"),align:"left",field:"displayname",sortable:!0},{name:"description",required:!0,label:this.$t("item.description.label"),align:"left",field:"description",sortable:!0},{name:"role",required:!0,label:this.$t("item.role.label"),align:"left",field:function(e){return e.role&&e.role.length?e.role.map(function(e){return e.role_name}).slice(0,3).join(", ")+(e.role.length>3?", + ".concat(e.role.length-3,"..."):""):""},sortable:!0},{name:"password-reset",label:"",required:!0},{name:"edit",label:"",required:!0}]}}},validations:{item:{username:{required:d["required"]},displayname:{},description:{},role:{}}},methods:{resetPassword:function(e){e&&e.user_id&&(this.passwordResetUserId=e.user_id,this.$refs.passwordResetModal.show())},newItem:function(){return c()},fetchItems:function(){var e=this;this.table.loading=!0,Promise.all([this.$axios.get(o["h"],{params:{eager:"[role]"}}),this.$axios.get(o["g"])]).then(function(t){e.table.data=t[0]&&t[0].data?t[0].data:[],e.options.roles=t[1]&&t[1].data?t[1].data.map(function(e){return{value:e,label:e.role_name,sublabel:e.description}}):[],e.table.loading=!1}).catch(function(){e.table.loading=!1})},deleteParams:function(e){return{user_id:e.user_id}}},mounted:function(){this.fetchItems()}},p=u,m=(s("rbhC"),s("KHd+")),h=s("sBt0"),f=Object(m["a"])(p,i,r,!1,null,null,null);"function"===typeof h["default"]&&Object(h["default"])(f);t["default"]=f.exports},Yfcy:function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"es":{"password":"Contrase√±a","password_new":"Contrase√±a nueva","password_reset":"Restablecer Contrase√±a","password_strength":"Fuerza de la Contrase√±a","password_repeat":"Repita la contrase√±a","password_missmatch":"Las contrase√±as no son iguales","reset_title":"Restablecer Contrase√±a","reset_message":"La contrase√±a sera restablecida para usuario:","password_reset_success":"Contrase√±a Restablecida","password_reset_error":"Error"}}'),delete e.options._Ctor}},rbhC:function(e,t,s){"use strict";var i=s("0Yji"),r=s.n(i);r.a},sBt0:function(e,t,s){"use strict";var i=s("2nmD"),r=s.n(i);t["default"]=r.a},uoC4:function(e,t,s){"use strict";var i=s("Yfcy"),r=s.n(i);t["default"]=r.a}}]);