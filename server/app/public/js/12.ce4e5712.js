(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{"2JDL":function(e,t,i){"use strict";var l=i("LN0X"),a=i.n(l);a.a},"2izI":function(e,t,i){"use strict";var l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"row"},[i("div",{staticClass:"col"},[e.showSelect?i("q-select",{attrs:{filter:"","hide-underline":"",value:e.value?e.value.schedule_id:null,options:e.standardScheduleOptions},on:{input:e.inputScheduleId}}):i("q-input",{attrs:{"hide-underline":"",value:e.value?e.value.schedule_name:""}})],1),i("div",{staticClass:"col-auto"},[e.value?i("q-btn",{attrs:{dense:"",color:"primary",flat:"",icon:"info"}},[i("q-popover",[i("schedule-compact",{attrs:{value:e.value}})],1)],1):e._e()],1),i("div",{staticClass:"col-auto"},[i("q-btn",{attrs:{dense:"",color:"primary",flat:"",icon:"search"},on:{click:function(t){e.$emit("input",null)}}},[i("q-tooltip",[e._v("\n        Escojer desde lista\n      ")])],1)],1),i("div",{staticClass:"col-auto"},[i("q-btn",{attrs:{dense:"",color:"primary",flat:"",icon:"edit"},on:{click:function(t){e.$refs.modal.show()}}},[i("q-tooltip",[e._v("\n        Crear jornada\n      ")])],1)],1),i("q-modal",{ref:"modal",attrs:{"content-css":"width: 80vw; height: 80vh;"}},[i("q-modal-layout",[i("q-toolbar",{staticClass:"q-py-none q-pr-none",attrs:{slot:"header"},slot:"header"},[i("q-toolbar-title"),i("q-btn",{staticClass:"no-shadow",staticStyle:{"border-radius":"0"},attrs:{icon:"close",color:"negative",size:"lg"},on:{click:function(t){e.$refs.modal.hide()}}})],1),i("q-toolbar",{staticClass:"justify-around q-py-sm",attrs:{slot:"footer",align:"around"},slot:"footer"},[i("q-btn",{attrs:{size:"lg",rounded:"",color:"positive",icon:"check",disable:!e.value},on:{click:function(t){e.$refs.modal.hide()}}},[e._v("Listo")])],1),i("div",{staticClass:"layout-padding"},[i("schedule",{attrs:{value:e.value},on:{input:e.inputSchedule}})],1)],1)],1)],1)},a=[];l._withStripped=!0;var o=i("MVZn"),s=i.n(o),n=i("L2JU"),d=i("k7eu"),r=i("+Lft"),c={name:"ScheduleSelect",components:{Schedule:d["a"],ScheduleCompact:r["a"]},props:{value:{type:Object,default:null}},data:function(){return{standard:!0}},computed:s()({},Object(n["c"])("hr",{standardScheduleOptions:"standardScheduleOptions"}),{showSelect:function(){return!this.value||this.value.standard}}),methods:s()({},Object(n["c"])("hr",{standardScheduleById:"standardScheduleById"}),{inputSchedule:function(e){this.$emit("input",e)},inputScheduleId:function(e){console.log(this.standardScheduleOptions),console.log(e);var t=this.standardScheduleById()(e);console.log(t);var i=JSON.parse(JSON.stringify(t));this.$emit("input",i)}})},u=c,m=(i("2JDL"),i("KHd+")),h=Object(m["a"])(u,l,a,!1,null,"16b07fea",null);t["a"]=h.exports},"8qvp":function(e,t,i){"use strict";var l=i("CCoy"),a=i.n(l);t["default"]=a.a},CCoy:function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"es":{"modal":{"title":"Turno","subtitle":" "}}}'),delete e.options._Ctor}},LN0X:function(e,t,i){},NNmX:function(e,t,i){"use strict";t["a"]={methods:{validationError:function(e){for(var t in e.$params)if(e.hasOwnProperty(t)&&!1===e[t])return this.$t("validation.".concat(t));return this.$t("validation.error")}}}},RTqZ:function(e,t,i){"use strict";var l=i("xwro"),a=i.n(l);a.a},RwI2:function(e,t,i){"use strict";i("yt8O"),i("RW0V"),i("rGqo");var l=i("MVZn"),a=i.n(l),o=i("L2JU");t["a"]={computed:a()({},Object(o["c"])("core",{isAuthorized:"isAuthorized"})),methods:{createItem:function(e){var t=this;this.$q.dialog({title:this.$t("confirm.createItem.title"),message:this.$t("confirm.createItem.message"),ok:!0,cancel:!0}).then(function(){t.$q.loading.show(),t.$axios.post(t.apiRoute,e).then(function(){t.$q.loading.hide(),t.$q.notify({message:t.$t("operation.create.success"),type:"positive"}),t.reset(),t.fetchItems()}).catch(function(){t.$q.loading.hide(),t.$q.notify({message:t.$t("operation.create.failure"),type:"warning"})})}).catch(function(){})},updateItem:function(e){var t=this;this.$q.dialog({title:this.$t("confirm.updateItem.title"),message:this.$t("confirm.updateItem.message"),ok:!0,cancel:!0}).then(function(){t.$q.loading.show(),t.$axios.put(t.apiRoute,e).then(function(){t.$q.loading.hide(),t.$q.notify({message:t.$t("operation.update.success"),type:"positive"}),t.reset(),t.fetchItems()}).catch(function(){t.$q.loading.hide(),t.$q.notify({message:t.$t("operation.update.failure"),type:"warning"})})}).catch(function(){})},deleteItem:function(e){var t=this;this.$q.dialog({title:this.$t("confirm.deleteItem.title"),message:this.$t("confirm.deleteItem.message"),ok:!0,cancel:!0}).then(function(){t.$q.loading.show(),t.$axios.delete(t.apiRoute,{params:t.deleteParams(e)}).then(function(){t.$q.loading.hide(),t.$q.notify({message:t.$t("operation.delete.success"),type:"positive"}),t.reset(),t.fetchItems()}).catch(function(){t.$q.loading.hide(),t.$q.notify({message:t.$t("operation.delete.failure"),type:"positive"})})}).catch(function(){})},edit:function(e){var t=this;e?(this.editMode=!0,this.item=JSON.parse(JSON.stringify(e)),this.mapItemOptions&&Object.keys(this.mapItemOptions).forEach(function(e){Array.isArray(t.item[e])?t.item[e]=t.item[e].map(t.mapItemOptions[e]):t.item[e]&&(t.item[e]=t.mapItemOptions[e](t.item[e]))}),delete this.item.__index):this.editMode=!1,this.$refs.modal.show()},reset:function(){this.$refs.modal.hide(),this.$v.$reset(),this.item=this.newItem()},cancel:function(){var e=this;this.$v.$anyDirty?this.$q.dialog({title:this.$t("confirm.cancelEdit.title"),message:this.$t("confirm.cancelEdit.message"),ok:!0,cancel:!0}).then(function(){e.reset()}):this.reset()}}}},"a7/6":function(e,t,i){"use strict";i.r(t);var l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-page",[i("q-table",{staticClass:"no-shadow",attrs:{title:e.table.title,"row-key":e.table.rowKey,loading:e.table.loading,data:e.table.data,columns:e.table.columns,filter:e.table.filter,pagination:e.table.pagination},on:{"update:pagination":function(t){e.$set(e.table,"pagination",t)}},scopedSlots:e._u([{key:"top-left",fn:function(t){return[i("q-btn",{staticClass:"q-mr-sm",attrs:{round:"",flat:"",color:"primary",icon:"refresh",size:"md"},on:{click:function(t){e.fetchItems()}}}),i("q-search",{staticClass:"col-6",attrs:{"hide-underline":"",color:"secondary"},model:{value:e.table.filter,callback:function(t){e.$set(e.table,"filter",t)},expression:"table.filter"}})]}},{key:"top-right",fn:function(t){return[e.isAuthorized(e.resource,"create","any")?i("q-btn",{attrs:{round:"",color:"positive",icon:"add",size:"md"},on:{click:function(t){e.edit()}}}):e._e()]}},{key:"body-cell-edit",fn:function(t){return i("q-td",{attrs:{props:t,"auto-width":""}},[e.isAuthorized(e.resource,["update","delete"],"any")?i("q-btn",{attrs:{size:"md",round:"",dense:"",flat:"",icon:"edit",color:"dark"},on:{click:function(i){e.edit(t.row)}}}):e._e()],1)}}])}),i("q-modal",{ref:"modal",attrs:{"no-esc-dismiss":"","no-backdrop-dismiss":"","content-css":"width: 80vw; height: 80vh;"}},[i("q-modal-layout",[i("q-toolbar",{staticClass:"q-py-none q-pr-none",attrs:{slot:"header"},slot:"header"},[i("q-toolbar-title",[e._v("\n          "+e._s(e.editMode?e.$t("edit"):e.$t("create"))+" "+e._s(e.$t("modal.title"))+"\n          "),i("span",{attrs:{slot:"subtitle"},slot:"subtitle"},[e._v(e._s(e.$t("modal.subtitle")))])]),i("q-btn",{staticClass:"no-shadow",staticStyle:{"border-radius":"0"},attrs:{icon:"close",color:"negative",size:"lg"},on:{click:function(t){e.cancel()}}})],1),i("q-toolbar",{staticClass:"justify-around q-py-sm",attrs:{slot:"footer",align:"around"},slot:"footer"},[e.editMode?[e.isAuthorized(e.resource,"delete","any")?i("q-btn",{attrs:{size:"lg",rounded:"",color:"negative",icon:"delete"},on:{click:function(t){e.deleteItem(e.item)}}},[e._v(e._s(e.$t("buttons.deleteItem")))]):e._e(),e.isAuthorized(e.resource,"update","any")?i("q-btn",{attrs:{size:"lg",rounded:"",color:"positive",icon:"save",disable:e.$v.item.$invalid},on:{click:function(t){e.updateItem(e.item)}}},[e._v(e._s(e.$t("buttons.updateItem")))]):e._e()]:[e.isAuthorized(e.resource,"create","any")?i("q-btn",{attrs:{size:"lg",rounded:"",color:"positive",icon:"create",disable:e.$v.item.$invalid},on:{click:function(t){e.createItem(e.item)}}},[e._v(e._s(e.$t("buttons.createItem")))]):e._e()]],2),i("div",{staticClass:"layout-padding group"},[i("q-field",{attrs:{label:e.$t("field.shift_name.label"),helper:e.$t("field.shift_name.helper"),error:e.$v.item.shift_name.$error,"error-label":e.validationError(e.$v.item.shift_name)}},[i("q-input",{attrs:{placeholder:e.$t("field.shift_name.placeholder")},model:{value:e.$v.item.shift_name.$model,callback:function(t){e.$set(e.$v.item.shift_name,"$model",t)},expression:"$v.item.shift_name.$model"}})],1),i("q-field",{attrs:{label:e.$t("field.description.label"),helper:e.$t("field.description.helper"),error:e.$v.item.description.$error,"error-label":e.validationError(e.$v.item.description)}},[i("q-input",{attrs:{placeholder:e.$t("field.description.placeholder")},model:{value:e.$v.item.description.$model,callback:function(t){e.$set(e.$v.item.description,"$model",t)},expression:"$v.item.description.$model"}})],1),i("q-field",{attrs:{label:e.$t("field.employee_id.label"),helper:e.$t("field.employee_id.helper"),error:e.$v.item.employee_id.$error,"error-label":e.validationError(e.$v.item.employee_id)}},[i("q-select",{attrs:{filter:"",options:e.subordinateEmployeeOptions,placeholder:e.$t("field.employee_id.placeholder")},model:{value:e.$v.item.employee_id.$model,callback:function(t){e.$set(e.$v.item.employee_id,"$model",t)},expression:"$v.item.employee_id.$model"}})],1),i("q-field",{attrs:{label:e.$t("field.start_date.label"),helper:e.$t("field.start_date.helper"),error:e.$v.item.start_date.$error,"error-label":e.validationError(e.$v.item.start_date)}},[i("q-datetime",{attrs:{type:"date",placeholder:e.$t("field.start_date.placeholder")},model:{value:e.$v.item.start_date.$model,callback:function(t){e.$set(e.$v.item.start_date,"$model",t)},expression:"$v.item.start_date.$model"}})],1),i("q-field",{attrs:{label:e.$t("field.end_date.label"),helper:e.$t("field.end_date.helper"),error:e.$v.item.end_date.$error,"error-label":e.validationError(e.$v.item.end_date)}},[i("q-datetime",{attrs:{type:"date",clearable:"",placeholder:e.$t("field.end_date.placeholder")},model:{value:e.$v.item.end_date.$model,callback:function(t){e.$set(e.$v.item.end_date,"$model",t)},expression:"$v.item.end_date.$model"}})],1),i("div",{staticClass:"q-headline"},[e._v("Jornadas")]),i("div",{staticClass:"q-py-md"},[e._l(e.$v.item.slots.$each.$iter,function(t,l){return i("div",{key:l},[i("q-field",{attrs:{label:e.slotLabel(l)}},[i("div",{staticClass:"row"},[i("schedule-select",{staticClass:"col",on:{input:function(e){t.schedule_id.$model=e&&e.schedule_id?e.schedule_id:null}},model:{value:t.schedule.$model,callback:function(i){e.$set(t.schedule,"$model",i)},expression:"slot.schedule.$model"}}),i("div",{staticClass:"col-auto"},[i("q-btn",{attrs:{dense:"",color:"negative",icon:"close"},on:{click:function(t){e.$v.item.slots.$model.splice(Number(l),1)}}},[i("q-tooltip",[e._v("Quitar Dia")])],1)],1)],1)]),i("hr")],1)}),i("div",{staticClass:"row justify-around items-center q-mt-lg"},[i("q-btn",{attrs:{rounded:"",color:"positive",icon:"add"},on:{click:function(t){e.$v.item.slots.$model.push({index:e.$v.item.slots.$model.length,schedule:null,schedule_id:null})}}},[i("q-tooltip",[e._v("Aggregar Jornada")])],1)],1)],2)],1)],1)],1)],1)},a=[];l._withStripped=!0;i("xfY5"),i("VRzm"),i("rGqo"),i("yt8O");var o=i("MVZn"),s=i.n(o),n=i("2LSj"),d=i("L2JU"),r=i("RwI2"),c=i("NNmX"),u=i("2izI"),m=i("ta7f");function h(){return{shift_name:"",description:"",employee_id:null,start_date:null,end_date:null,slots:[{index:0,schedule:null,schedule_id:null},{index:1,schedule:null,schedule_id:null},{index:2,schedule:null,schedule_id:null},{index:3,schedule:null,schedule_id:null},{index:4,schedule:null,schedule_id:null},{index:5,schedule:null,schedule_id:null},{index:6,schedule:null,schedule_id:null}]}}var f={name:"HRAttShift",mixins:[r["a"],c["a"]],components:{ScheduleSelect:u["a"]},data:function(){return{resource:"HRAttShift",apiRoute:n["m"],editMode:!1,item:h(),schedulePresets:[],timetableTypes:[],mapItemOptions:{},options:{employee_id:[]},table:{loading:!1,rowKey:"shift_id",title:"",filter:"",data:[],pagination:{sortBy:null,descending:!1,page:1,rowsPerPage:10},columns:[{name:"shift_name",required:!0,label:this.$t("field.shift_name.label"),align:"left",field:"shift_name",sortable:!0},{name:"description",required:!0,label:this.$t("field.description.label"),align:"left",field:"description",sortable:!0},{name:"employee",required:!0,label:this.$t("field.name.label"),align:"left",field:function(e){return e.employee.name_first},sortable:!0},{name:"slots",required:!0,label:this.$t("field.shift_slots.label"),align:"left",field:function(e){return e.slots.length},sortable:!0},{name:"edit",label:"",required:!0}]}}},validations:{item:{shift_name:{},description:{},employee_id:{required:m["required"]},start_date:{required:m["required"]},end_date:{},slots:{$each:{schedule:{requiredIf:Object(m["requiredIf"])(function(e){return console.log(e),!e.schedule_id})},schedule_id:{requiredIf:Object(m["requiredIf"])(function(e){return!e.schedule||e.schedule&&e.schedule.schedule_id})},index:{required:m["required"]}}}}},computed:s()({},Object(d["c"])("hr",{subordinateEmployeeOptions:"subordinateEmployeeOptions"})),methods:s()({},Object(d["b"])("hr",{fetchTimetypes:"fetchTimetypes",fetchSubordinateEmployees:"fetchSubordinateEmployees",fetchStandardSchedules:"fetchStandardSchedules"}),{slotInput:function(e,t){this.$q.notify("input received"),this.$set(this.item.slots,t,e)},newItem:function(){return h()},fetchItems:function(){var e=this;this.table.loading=!0,Promise.all([this.$axios.get(n["m"],{params:{eager:"[employee, slots.schedule.[breaktime, uptime, downtime]]"}}),this.fetchTimetypes(),this.fetchSubordinateEmployees(),this.fetchStandardSchedules()]).then(function(t){e.table.data=t[0]&&t[0].data?t[0].data:[],e.table.loading=!1}).catch(function(){e.table.loading=!1})},deleteParams:function(e){return{shift_id:e.shift_id}},slotLabel:function(e){return"Jornada ".concat(Number(e)+1)+(this.item.start_date?this.$date.formatDate(this.$date.addToDate(new Date(this.item.start_date),{days:Number(e)})," - dddd D"):"")}}),mounted:function(){this.fetchItems()}},p=f,$=(i("RTqZ"),i("KHd+")),v=i("8qvp"),b=Object($["a"])(p,l,a,!1,null,null,null);"function"===typeof v["default"]&&Object(v["default"])(b);t["default"]=b.exports},xwro:function(e,t,i){}}]);