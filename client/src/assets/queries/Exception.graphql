mutation CreateExceptionMutation ($data: ExceptionCreateInput!) {
  exception: createException (data: $data) {
    id
    employee {
      nameFull
    }
    owner {
      username
    }
  }
}

mutation RejectExceptionMutation ($data: ExceptionRejectionCreateInput! $where: ExceptionWhereUniqueInput!) {
  exception: rejectException (where: $where data: $data) {
    id
    employee {
      nameFull
    }
    owner {
      username
    }
  }
}

mutation AuthorizeExceptionMutation ($data: ExceptionAuthorizationCreateInput! $where: ExceptionWhereUniqueInput!) {
  exception: authorizeException (where: $where data: $data) {
    id
    employee {
      nameFull
    }
    owner {
      username
    }
  }
}

mutation CancelExceptionMutation ($data: ExceptionCancellationCreateInput! $where: ExceptionWhereUniqueInput!) {
  exception: cancelException (where: $where data: $data) {
    id
    employee {
      nameFull
    }
    owner {
      username
    }
  }
}

mutation DeleteExceptionMutation ($where: ExceptionWhereUniqueInput! $data: ExceptionEliminationCreateInput!) {
  exception: deleteException (where: $where, data: $data) {
    id
    employee {
      nameFull
    }
    owner {
      username
    }
  }
}

query ExceptionsPaginationQuery ($first: Int! $skip: Int! $where: ExceptionWhereInput) {
  meta: exceptionsConnection (where: $where) {
    aggregate {
      count
    }
  }
  data: exceptions (first: $first skip: $skip orderBy: createdAt_DESC where: $where) {
    id
    employee {
      id
      nameFull
    }
    createdAt
    owner {
      username
    }
    rejection {
      createdAt
      owner {
        username
      }
    }
    authorization {
      createdAt
      owner {
        username
      }
    }
    cancellation {
      createdAt
      owner {
        username
      }
    }
  }
}

query ExceptionWithScheduleDataQuery ($where: ExceptionWhereUniqueInput!) {
	exception (where: $where) {
    id
    createdAt
    authorization {
      id
      createdAt
      description
      owner {
        username
      }
    }
    rejection {
      id
      createdAt
      description
      owner {
        username
      }
    }
    cancellation {
      id
      createdAt
      description
      owner {
        username
      }
    }
    employee {
      id
      nameFull
    }
    owner {
      username
    }
    slots {
      date
      schedule {
        id
        ...AllScheduleData
      }
    }
  }
}

fragment AllScheduleData on Schedule {
  description
  baseTime
  timeline (orderBy: startTime_ASC) {
    category
    startTime
    startEventRequired
    endTime
    endEventRequired
  }
  restline (orderBy: startTime_ASC) {
    category
    startTime
    startEventRequired
    endTime
    endEventRequired
    duration
  }
  offline1 {
    category
  }
  offline2 {
    category
  }
}
